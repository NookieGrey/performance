// node src/generatorUtils.mjs --experimental-modules

const json = [{"data":[{"x":0,"y":75},{"x":1,"y":58},{"x":2,"y":60},{"x":3,"y":62},{"x":4,"y":61},{"x":5,"y":61},{"x":6,"y":61},{"x":7,"y":61},{"x":8,"y":62},{"x":9,"y":61},{"x":10,"y":62},{"x":11,"y":62},{"x":12,"y":60},{"x":13,"y":58},{"x":14,"y":62},{"x":15,"y":62},{"x":16,"y":60},{"x":17,"y":59},{"x":18,"y":59},{"x":19,"y":60},{"x":20,"y":62},{"x":21,"y":62},{"x":22,"y":61},{"x":23,"y":97},{"x":24,"y":60},{"x":25,"y":61},{"x":26,"y":61},{"x":27,"y":62},{"x":28,"y":62},{"x":29,"y":64},{"x":30,"y":60},{"x":31,"y":60},{"x":32,"y":60},{"x":33,"y":60},{"x":34,"y":61},{"x":35,"y":61},{"x":36,"y":60},{"x":37,"y":62},{"x":38,"y":61},{"x":39,"y":62},{"x":40,"y":62},{"x":41,"y":62},{"x":42,"y":61},{"x":43,"y":59},{"x":44,"y":61},{"x":45,"y":61},{"x":46,"y":60},{"x":47,"y":63},{"x":48,"y":62},{"x":49,"y":62},{"x":50,"y":60},{"x":51,"y":61},{"x":52,"y":62},{"x":53,"y":61},{"x":54,"y":61},{"x":55,"y":62},{"x":56,"y":62},{"x":57,"y":60},{"x":58,"y":60},{"x":59,"y":60},{"x":60,"y":60},{"x":61,"y":61},{"x":62,"y":64},{"x":63,"y":61},{"x":64,"y":61},{"x":65,"y":61},{"x":66,"y":62},{"x":67,"y":60},{"x":68,"y":61},{"x":69,"y":60},{"x":70,"y":61},{"x":71,"y":97},{"x":72,"y":59},{"x":73,"y":61},{"x":74,"y":62},{"x":75,"y":61},{"x":76,"y":59},{"x":77,"y":61},{"x":78,"y":62},{"x":79,"y":60},{"x":80,"y":60},{"x":81,"y":61},{"x":82,"y":60},{"x":83,"y":61},{"x":84,"y":61},{"x":85,"y":62},{"x":86,"y":61},{"x":87,"y":60},{"x":88,"y":61},{"x":89,"y":63},{"x":90,"y":61},{"x":91,"y":60},{"x":92,"y":61},{"x":93,"y":61},{"x":94,"y":59},{"x":95,"y":61},{"x":96,"y":61},{"x":97,"y":62},{"x":98,"y":60},{"x":99,"y":61}],"name":"update-ComponentEEE","average":61,"index":0},{"data":[{"x":0,"y":82},{"x":1,"y":60},{"x":2,"y":62},{"x":3,"y":61},{"x":4,"y":63},{"x":5,"y":61},{"x":6,"y":59},{"x":7,"y":59},{"x":8,"y":60},{"x":9,"y":59},{"x":10,"y":59},{"x":11,"y":61},{"x":12,"y":60},{"x":13,"y":60},{"x":14,"y":97},{"x":15,"y":60},{"x":16,"y":59},{"x":17,"y":60},{"x":18,"y":61},{"x":19,"y":61},{"x":20,"y":61},{"x":21,"y":61},{"x":22,"y":59},{"x":23,"y":60},{"x":24,"y":59},{"x":25,"y":60},{"x":26,"y":60},{"x":27,"y":61},{"x":28,"y":62},{"x":29,"y":59},{"x":30,"y":60},{"x":31,"y":61},{"x":32,"y":61},{"x":33,"y":58},{"x":34,"y":59},{"x":35,"y":58},{"x":36,"y":59},{"x":37,"y":62},{"x":38,"y":61},{"x":39,"y":60},{"x":40,"y":60},{"x":41,"y":61},{"x":42,"y":61},{"x":43,"y":60},{"x":44,"y":60},{"x":45,"y":61},{"x":46,"y":62},{"x":47,"y":61},{"x":48,"y":60},{"x":49,"y":61},{"x":50,"y":59},{"x":51,"y":59},{"x":52,"y":61},{"x":53,"y":61},{"x":54,"y":59},{"x":55,"y":60},{"x":56,"y":61},{"x":57,"y":59},{"x":58,"y":59},{"x":59,"y":58},{"x":60,"y":59},{"x":61,"y":59},{"x":62,"y":99},{"x":63,"y":61},{"x":64,"y":61},{"x":65,"y":60},{"x":66,"y":61},{"x":67,"y":60},{"x":68,"y":61},{"x":69,"y":60},{"x":70,"y":61},{"x":71,"y":63},{"x":72,"y":63},{"x":73,"y":61},{"x":74,"y":61},{"x":75,"y":61},{"x":76,"y":60},{"x":77,"y":60},{"x":78,"y":60},{"x":79,"y":60},{"x":80,"y":61},{"x":81,"y":60},{"x":82,"y":61},{"x":83,"y":61},{"x":84,"y":60},{"x":85,"y":61},{"x":86,"y":58},{"x":87,"y":59},{"x":88,"y":60},{"x":89,"y":60},{"x":90,"y":60},{"x":91,"y":60},{"x":92,"y":60},{"x":93,"y":61},{"x":94,"y":60},{"x":95,"y":59},{"x":96,"y":59},{"x":97,"y":60},{"x":98,"y":61},{"x":99,"y":62}],"name":"update-ComponentEEM","average":60,"index":1},{"data":[{"x":0,"y":75},{"x":1,"y":58},{"x":2,"y":61},{"x":3,"y":60},{"x":4,"y":60},{"x":5,"y":60},{"x":6,"y":61},{"x":7,"y":62},{"x":8,"y":61},{"x":9,"y":60},{"x":10,"y":61},{"x":11,"y":60},{"x":12,"y":61},{"x":13,"y":60},{"x":14,"y":59},{"x":15,"y":61},{"x":16,"y":59},{"x":17,"y":60},{"x":18,"y":59},{"x":19,"y":60},{"x":20,"y":60},{"x":21,"y":61},{"x":22,"y":60},{"x":23,"y":59},{"x":24,"y":60},{"x":25,"y":61},{"x":26,"y":61},{"x":27,"y":60},{"x":28,"y":59},{"x":29,"y":61},{"x":30,"y":59},{"x":31,"y":61},{"x":32,"y":60},{"x":33,"y":61},{"x":34,"y":60},{"x":35,"y":60},{"x":36,"y":60},{"x":37,"y":60},{"x":38,"y":61},{"x":39,"y":60},{"x":40,"y":60},{"x":41,"y":61},{"x":42,"y":61},{"x":43,"y":60},{"x":44,"y":60},{"x":45,"y":97},{"x":46,"y":61},{"x":47,"y":61},{"x":48,"y":61},{"x":49,"y":61},{"x":50,"y":60},{"x":51,"y":61},{"x":52,"y":62},{"x":53,"y":60},{"x":54,"y":59},{"x":55,"y":61},{"x":56,"y":60},{"x":57,"y":61},{"x":58,"y":65},{"x":59,"y":63},{"x":60,"y":61},{"x":61,"y":60},{"x":62,"y":61},{"x":63,"y":62},{"x":64,"y":61},{"x":65,"y":60},{"x":66,"y":61},{"x":67,"y":60},{"x":68,"y":62},{"x":69,"y":62},{"x":70,"y":63},{"x":71,"y":61},{"x":72,"y":60},{"x":73,"y":61},{"x":74,"y":61},{"x":75,"y":61},{"x":76,"y":60},{"x":77,"y":60},{"x":78,"y":60},{"x":79,"y":60},{"x":80,"y":59},{"x":81,"y":61},{"x":82,"y":61},{"x":83,"y":61},{"x":84,"y":62},{"x":85,"y":62},{"x":86,"y":60},{"x":87,"y":61},{"x":88,"y":62},{"x":89,"y":62},{"x":90,"y":62},{"x":91,"y":61},{"x":92,"y":61},{"x":93,"y":61},{"x":94,"y":97},{"x":95,"y":62},{"x":96,"y":62},{"x":97,"y":62},{"x":98,"y":61},{"x":99,"y":60}],"name":"update-ComponentEME","average":61,"index":2},{"data":[{"x":0,"y":84},{"x":1,"y":68},{"x":2,"y":101},{"x":3,"y":62},{"x":4,"y":61},{"x":5,"y":60},{"x":6,"y":57},{"x":7,"y":60},{"x":8,"y":58},{"x":9,"y":61},{"x":10,"y":59},{"x":11,"y":64},{"x":12,"y":63},{"x":13,"y":62},{"x":14,"y":59},{"x":15,"y":57},{"x":16,"y":61},{"x":17,"y":61},{"x":18,"y":60},{"x":19,"y":60},{"x":20,"y":60},{"x":21,"y":59},{"x":22,"y":60},{"x":23,"y":60},{"x":24,"y":60},{"x":25,"y":59},{"x":26,"y":57},{"x":27,"y":59},{"x":28,"y":57},{"x":29,"y":58},{"x":30,"y":60},{"x":31,"y":60},{"x":32,"y":58},{"x":33,"y":59},{"x":34,"y":57},{"x":35,"y":58},{"x":36,"y":58},{"x":37,"y":57},{"x":38,"y":60},{"x":39,"y":59},{"x":40,"y":57},{"x":41,"y":59},{"x":42,"y":58},{"x":43,"y":59},{"x":44,"y":97},{"x":45,"y":61},{"x":46,"y":60},{"x":47,"y":60},{"x":48,"y":59},{"x":49,"y":61},{"x":50,"y":61},{"x":51,"y":59},{"x":52,"y":62},{"x":53,"y":60},{"x":54,"y":60},{"x":55,"y":57},{"x":56,"y":60},{"x":57,"y":60},{"x":58,"y":58},{"x":59,"y":61},{"x":60,"y":59},{"x":61,"y":60},{"x":62,"y":59},{"x":63,"y":58},{"x":64,"y":59},{"x":65,"y":58},{"x":66,"y":61},{"x":67,"y":60},{"x":68,"y":59},{"x":69,"y":62},{"x":70,"y":61},{"x":71,"y":61},{"x":72,"y":59},{"x":73,"y":59},{"x":74,"y":60},{"x":75,"y":59},{"x":76,"y":60},{"x":77,"y":61},{"x":78,"y":60},{"x":79,"y":60},{"x":80,"y":60},{"x":81,"y":62},{"x":82,"y":59},{"x":83,"y":59},{"x":84,"y":64},{"x":85,"y":91},{"x":86,"y":61},{"x":87,"y":60},{"x":88,"y":61},{"x":89,"y":61},{"x":90,"y":61},{"x":91,"y":66},{"x":92,"y":64},{"x":93,"y":57},{"x":94,"y":57},{"x":95,"y":61},{"x":96,"y":58},{"x":97,"y":61},{"x":98,"y":60},{"x":99,"y":61}],"name":"update-ComponentEMM","average":60,"index":3},{"data":[{"x":0,"y":75},{"x":1,"y":60},{"x":2,"y":62},{"x":3,"y":62},{"x":4,"y":61},{"x":5,"y":61},{"x":6,"y":63},{"x":7,"y":62},{"x":8,"y":61},{"x":9,"y":62},{"x":10,"y":100},{"x":11,"y":62},{"x":12,"y":61},{"x":13,"y":63},{"x":14,"y":62},{"x":15,"y":63},{"x":16,"y":62},{"x":17,"y":61},{"x":18,"y":63},{"x":19,"y":62},{"x":20,"y":62},{"x":21,"y":62},{"x":22,"y":62},{"x":23,"y":62},{"x":24,"y":62},{"x":25,"y":61},{"x":26,"y":61},{"x":27,"y":62},{"x":28,"y":65},{"x":29,"y":64},{"x":30,"y":61},{"x":31,"y":61},{"x":32,"y":61},{"x":33,"y":63},{"x":34,"y":63},{"x":35,"y":60},{"x":36,"y":62},{"x":37,"y":63},{"x":38,"y":63},{"x":39,"y":61},{"x":40,"y":63},{"x":41,"y":60},{"x":42,"y":61},{"x":43,"y":62},{"x":44,"y":63},{"x":45,"y":62},{"x":46,"y":62},{"x":47,"y":61},{"x":48,"y":60},{"x":49,"y":62},{"x":50,"y":62},{"x":51,"y":63},{"x":52,"y":67},{"x":53,"y":66},{"x":54,"y":63},{"x":55,"y":62},{"x":56,"y":62},{"x":57,"y":62},{"x":58,"y":62},{"x":59,"y":98},{"x":60,"y":62},{"x":61,"y":62},{"x":62,"y":61},{"x":63,"y":62},{"x":64,"y":63},{"x":65,"y":62},{"x":66,"y":62},{"x":67,"y":61},{"x":68,"y":62},{"x":69,"y":61},{"x":70,"y":61},{"x":71,"y":62},{"x":72,"y":61},{"x":73,"y":61},{"x":74,"y":63},{"x":75,"y":62},{"x":76,"y":62},{"x":77,"y":62},{"x":78,"y":64},{"x":79,"y":63},{"x":80,"y":61},{"x":81,"y":62},{"x":82,"y":62},{"x":83,"y":62},{"x":84,"y":63},{"x":85,"y":62},{"x":86,"y":63},{"x":87,"y":61},{"x":88,"y":62},{"x":89,"y":61},{"x":90,"y":63},{"x":91,"y":64},{"x":92,"y":65},{"x":93,"y":63},{"x":94,"y":63},{"x":95,"y":60},{"x":96,"y":62},{"x":97,"y":61},{"x":98,"y":61},{"x":99,"y":62}],"name":"update-ComponentMEE","average":62,"index":4},{"data":[{"x":0,"y":74},{"x":1,"y":60},{"x":2,"y":61},{"x":3,"y":98},{"x":4,"y":62},{"x":5,"y":60},{"x":6,"y":61},{"x":7,"y":63},{"x":8,"y":62},{"x":9,"y":62},{"x":10,"y":63},{"x":11,"y":60},{"x":12,"y":61},{"x":13,"y":62},{"x":14,"y":61},{"x":15,"y":60},{"x":16,"y":63},{"x":17,"y":61},{"x":18,"y":60},{"x":19,"y":61},{"x":20,"y":61},{"x":21,"y":62},{"x":22,"y":61},{"x":23,"y":65},{"x":24,"y":62},{"x":25,"y":60},{"x":26,"y":61},{"x":27,"y":60},{"x":28,"y":61},{"x":29,"y":62},{"x":30,"y":64},{"x":31,"y":61},{"x":32,"y":62},{"x":33,"y":62},{"x":34,"y":61},{"x":35,"y":61},{"x":36,"y":61},{"x":37,"y":62},{"x":38,"y":62},{"x":39,"y":60},{"x":40,"y":62},{"x":41,"y":60},{"x":42,"y":62},{"x":43,"y":62},{"x":44,"y":62},{"x":45,"y":61},{"x":46,"y":62},{"x":47,"y":60},{"x":48,"y":60},{"x":49,"y":62},{"x":50,"y":63},{"x":51,"y":62},{"x":52,"y":60},{"x":53,"y":61},{"x":54,"y":62},{"x":55,"y":60},{"x":56,"y":62},{"x":57,"y":59},{"x":58,"y":62},{"x":59,"y":61},{"x":60,"y":61},{"x":61,"y":61},{"x":62,"y":61},{"x":63,"y":71},{"x":64,"y":65},{"x":65,"y":62},{"x":66,"y":62},{"x":67,"y":59},{"x":68,"y":61},{"x":69,"y":62},{"x":70,"y":62},{"x":71,"y":61},{"x":72,"y":61},{"x":73,"y":61},{"x":74,"y":61},{"x":75,"y":61},{"x":76,"y":62},{"x":77,"y":62},{"x":78,"y":61},{"x":79,"y":62},{"x":80,"y":61},{"x":81,"y":62},{"x":82,"y":61},{"x":83,"y":61},{"x":84,"y":61},{"x":85,"y":61},{"x":86,"y":61},{"x":87,"y":61},{"x":88,"y":61},{"x":89,"y":63},{"x":90,"y":65},{"x":91,"y":61},{"x":92,"y":61},{"x":93,"y":60},{"x":94,"y":59},{"x":95,"y":62},{"x":96,"y":61},{"x":97,"y":62},{"x":98,"y":61},{"x":99,"y":60}],"name":"update-ComponentMEM","average":61,"index":5},{"data":[{"x":0,"y":74},{"x":1,"y":61},{"x":2,"y":61},{"x":3,"y":62},{"x":4,"y":62},{"x":5,"y":61},{"x":6,"y":62},{"x":7,"y":61},{"x":8,"y":62},{"x":9,"y":60},{"x":10,"y":63},{"x":11,"y":62},{"x":12,"y":62},{"x":13,"y":62},{"x":14,"y":63},{"x":15,"y":63},{"x":16,"y":59},{"x":17,"y":62},{"x":18,"y":59},{"x":19,"y":62},{"x":20,"y":62},{"x":21,"y":61},{"x":22,"y":61},{"x":23,"y":63},{"x":24,"y":63},{"x":25,"y":60},{"x":26,"y":62},{"x":27,"y":66},{"x":28,"y":61},{"x":29,"y":62},{"x":30,"y":62},{"x":31,"y":63},{"x":32,"y":62},{"x":33,"y":61},{"x":34,"y":96},{"x":35,"y":62},{"x":36,"y":61},{"x":37,"y":61},{"x":38,"y":63},{"x":39,"y":61},{"x":40,"y":60},{"x":41,"y":61},{"x":42,"y":63},{"x":43,"y":60},{"x":44,"y":63},{"x":45,"y":62},{"x":46,"y":62},{"x":47,"y":62},{"x":48,"y":61},{"x":49,"y":61},{"x":50,"y":63},{"x":51,"y":61},{"x":52,"y":62},{"x":53,"y":62},{"x":54,"y":61},{"x":55,"y":60},{"x":56,"y":62},{"x":57,"y":61},{"x":58,"y":61},{"x":59,"y":63},{"x":60,"y":62},{"x":61,"y":61},{"x":62,"y":63},{"x":63,"y":62},{"x":64,"y":62},{"x":65,"y":60},{"x":66,"y":62},{"x":67,"y":61},{"x":68,"y":61},{"x":69,"y":62},{"x":70,"y":62},{"x":71,"y":60},{"x":72,"y":62},{"x":73,"y":61},{"x":74,"y":61},{"x":75,"y":61},{"x":76,"y":61},{"x":77,"y":61},{"x":78,"y":62},{"x":79,"y":61},{"x":80,"y":61},{"x":81,"y":97},{"x":82,"y":62},{"x":83,"y":61},{"x":84,"y":61},{"x":85,"y":63},{"x":86,"y":63},{"x":87,"y":61},{"x":88,"y":62},{"x":89,"y":63},{"x":90,"y":62},{"x":91,"y":61},{"x":92,"y":60},{"x":93,"y":62},{"x":94,"y":62},{"x":95,"y":60},{"x":96,"y":66},{"x":97,"y":62},{"x":98,"y":62},{"x":99,"y":62}],"name":"update-ComponentMME","average":62,"index":6},{"data":[{"x":0,"y":81},{"x":1,"y":0},{"x":2,"y":0},{"x":3,"y":0},{"x":4,"y":0},{"x":5,"y":0},{"x":6,"y":0},{"x":7,"y":0},{"x":8,"y":0},{"x":9,"y":0},{"x":10,"y":0},{"x":11,"y":0},{"x":12,"y":0},{"x":13,"y":0},{"x":14,"y":0},{"x":15,"y":0},{"x":16,"y":0},{"x":17,"y":0},{"x":18,"y":0},{"x":19,"y":0},{"x":20,"y":0},{"x":21,"y":0},{"x":22,"y":0},{"x":23,"y":0},{"x":24,"y":0},{"x":25,"y":0},{"x":26,"y":0},{"x":27,"y":0},{"x":28,"y":0},{"x":29,"y":0},{"x":30,"y":0},{"x":31,"y":0},{"x":32,"y":0},{"x":33,"y":0},{"x":34,"y":0},{"x":35,"y":0},{"x":36,"y":0},{"x":37,"y":0},{"x":38,"y":0},{"x":39,"y":0},{"x":40,"y":0},{"x":41,"y":0},{"x":42,"y":0},{"x":43,"y":0},{"x":44,"y":0},{"x":45,"y":0},{"x":46,"y":0},{"x":47,"y":0},{"x":48,"y":0},{"x":49,"y":0},{"x":50,"y":0},{"x":51,"y":0},{"x":52,"y":0},{"x":53,"y":0},{"x":54,"y":0},{"x":55,"y":0},{"x":56,"y":0},{"x":57,"y":0},{"x":58,"y":0},{"x":59,"y":0},{"x":60,"y":0},{"x":61,"y":0},{"x":62,"y":0},{"x":63,"y":0},{"x":64,"y":0},{"x":65,"y":0},{"x":66,"y":0},{"x":67,"y":0},{"x":68,"y":0},{"x":69,"y":0},{"x":70,"y":0},{"x":71,"y":0},{"x":72,"y":0},{"x":73,"y":0},{"x":74,"y":0},{"x":75,"y":0},{"x":76,"y":0},{"x":77,"y":0},{"x":78,"y":0},{"x":79,"y":0},{"x":80,"y":0},{"x":81,"y":0},{"x":82,"y":0},{"x":83,"y":0},{"x":84,"y":0},{"x":85,"y":0},{"x":86,"y":0},{"x":87,"y":0},{"x":88,"y":0},{"x":89,"y":0},{"x":90,"y":0},{"x":91,"y":0},{"x":92,"y":0},{"x":93,"y":0},{"x":94,"y":0},{"x":95,"y":0},{"x":96,"y":0},{"x":97,"y":0},{"x":98,"y":0},{"x":99,"y":0}],"name":"update-ComponentMMM","average":0,"index":7}];

Promise.resolve(json)
    .then(removeOutliers)
    .then(JSON.stringify)
    .then(console.log.bind(console));

function generateFromString() {
    Promise.resolve({
        "normal": "[1,14,2]",
        "patched": "[2,11,3]",
    })
        .then(convertLocalStorageObj)
        .then(addAverage)
        .then(sort)
        .then(convert)
        .then(JSON.stringify)
        .then(console.log.bind(console));
}

function removeOutliers(json) {
    return json.map(item => {
        let q1, q3, iqr, maxValue, minValue;

        let values = item.data.slice().sort((dataItem1, dataItem2) => dataItem1.y - dataItem2.y);

        if ((values.length / 4) % 1 === 0) {//find quartiles
            q1 = 1 / 2 * (values[(values.length / 4)].y + values[(values.length / 4) + 1].y);
            q3 = 1 / 2 * (values[(values.length * (3 / 4))].y + values[(values.length * (3 / 4)) + 1].y);
        } else {
            q1 = values[Math.floor(values.length / 4 + 1)].y;
            q3 = values[Math.ceil(values.length * (3 / 4) + 1)].y;
        }

        iqr = q3 - q1;
        maxValue = q3 + iqr * 1.5;
        minValue = q1 - iqr * 1.5;

        const data = item.data.filter((dataItem) => (dataItem.y >= minValue) && (dataItem.y <= maxValue)).map((dataItem, x) => ({
            ...dataItem,
            x,
        }));

        return {
            ...item,
            data,
        }
    })
}

function convertLocalStorageObj(obj) {
    return Object.keys(obj).map(key => ({
        data: JSON.parse(obj[key]),
        name: key
    }))
}

function getDataFromLocalStorage() {
    delete localStorage.typeIndex;

    return Array(localStorage.length).fill(0).map((item, index) => ({
        data: JSON.parse(localStorage.getItem(localStorage.key(index))),
        name: localStorage.key(index)
    }))
}

function addAverage(json) {
    return json.map(item => ({
        ...item,
        average: Math.round(arithmeticMean(filterOutliers(item.data)))
    }));
}

function sort(arr) {
    return arr
        .sort(function (a, b) {
            if (a.name > b.name) {
                return 1;
            }
            if (a.name < b.name) {
                return -1;
            }
            // a должно быть равным b
            return 0;
        })
}

function convert(arr) {
    return arr.map((item, index) => ({
        ...item,
        data: item.data.map((value, index) => ({x: index, y: value})),
        index
    }))
}

function arithmeticMean(arr) {
    let sum = 0;

    arr.forEach(value => sum += (value / arr.length));

    return sum;
}

// https://gist.github.com/rmeissn/f5b42fb3e1386a46f60304a57b6d215a
function filterOutliers(someArray) {
    if (someArray.length < 4)
        return someArray;

    let values, q1, q3, iqr, maxValue, minValue;

    values = someArray.slice().sort((a, b) => a - b);//copy array fast and sort

    if ((values.length / 4) % 1 === 0) {//find quartiles
        q1 = 1 / 2 * (values[(values.length / 4)] + values[(values.length / 4) + 1]);
        q3 = 1 / 2 * (values[(values.length * (3 / 4))] + values[(values.length * (3 / 4)) + 1]);
    } else {
        q1 = values[Math.floor(values.length / 4 + 1)];
        q3 = values[Math.ceil(values.length * (3 / 4) + 1)];
    }

    iqr = q3 - q1;
    maxValue = q3 + iqr * 1.5;
    minValue = q1 - iqr * 1.5;

    return values.filter((x) => (x >= minValue) && (x <= maxValue));
}